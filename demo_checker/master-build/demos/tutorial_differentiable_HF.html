
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta content="Learn how to use the differentiable Hartree-Fock solver" property="og:description" />
<meta content="https://pennylane.ai/qml/_images/differentiable_HF.png" property="og:image" />

  <link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
  <link rel="shortcut icon" type="image/x-icon" href="../_static/favicon.ico">
  


  <meta property="og:title" content="Differentiable Hartree-Fock &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_differentiable_HF.html">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Learn how to use the differentiable Hartree-Fock solver" property="og:description" />
  

  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto&display=swap">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- Material Design Bootstrap -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.14/css/mdb.min.css">
  <!-- NanoScroller -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/css/nanoscroller.min.css">
  <!-- Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/tomorrow-night.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['\\hat{\\mathbf{1}}',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0],
           expect: ["\\langle #1 \\rangle",1],
           pde: ["\\frac{\\partial}{\\partial \#1}",1],
           R: ["\\mathbb{R}",0],
           C: ["\\mathbb{C}",0],
           Ad: ["\\text{Ad}",0],
           Var: ["\\text{Var}",0],
           bx: ["\\mathbf{x}", 0],
           bm: ["\\boldsymbol{\#1}",1],
           haf: ["\\mathrm{haf}",0],
           lhaf: ["\\mathrm{lhaf}",0]
         }
       }
     });
     </script>

  <!-- Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-130507810-1');
      </script>
  
    <title>Differentiable Hartree-Fock &#8212; PennyLane  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/light-slider.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/hubs.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_differentiable_HF.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adaptive circuits for quantum chemistry" href="tutorial_adaptive_circuits.html" />
    <link rel="prev" title="Givens rotations for quantum chemistry" href="tutorial_givens_rotations.html" /> 
  </head><body><nav class="navbar navbar-expand-lg navbar-light white sticky-top">

<!-- Logo and Title -->









  



  <a class="navbar-brand nav-link" href="https://pennylane.ai">
    
  <img class="pr-1" src=" ../_static/logo.png" width="28px"></img>
  
    <img id="navbar-wordmark" src="../_static/pennylane.svg"></img>
  
  </a>


  <!-- [Mobile] Collapse Button -->
  <div class="row right">
    

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
      aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </div>

  <!-- [Mobile] Collapsible Content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links on the Left -->
    <ul class="navbar-nav mr-auto">
      
        
          
            <li class="nav-item active">
              <a class="nav-link" href="https://pennylane.ai/qml/">
                
  
    Learn
  

              </a>
              <span class="sr-only">(current)</span>
            </li>
          

        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/qml/demonstrations.html">
                
  
    Demos
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/install.html">
                
  
    Install
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/plugins.html">
                
  
    Plugins
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://docs.pennylane.ai">
                
  
    Documentation
  

            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a class="nav-link" href="https://pennylane.ai/blog/">
                
  
    Blog
  

            </a>
          </li>
        
      
    </ul>

    <!-- Links on the Right -->
    <ul class="navbar-nav ml-auto nav-flex-icons">
      
        <li class="nav-item">
          <a class="nav-link" href="https://pennylane.ai/faq.html">
            <i class="fas fa-question pr-1"></i> FAQ
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://discuss.pennylane.ai/">
            <i class="fab fa-discourse pr-1"></i> Support
          </a>
        </li>
      
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PennyLaneAI/pennylane">
            <i class="fab fa-github pr-1"></i> GitHub
          </a>
        </li>
      

    </ul>
  </div>

</nav>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial_adaptive_circuits.html" title="Adaptive circuits for quantum chemistry"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_givens_rotations.html" title="Givens rotations for quantum chemistry"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-chemistry.html" accesskey="U">Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Differentiable Hartree-Fock</a></li> 
      </ul>
    </div>
    <div class="container-wrapper">
        <div id="content">
          <div id="right-column">
            
            

            <div class="document clearer body">
              
    <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-differentiable-hf-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="differentiable-hartree-fock">
<span id="sphx-glr-demos-tutorial-differentiable-hf-py"></span><h1>Differentiable Hartree-Fock<a class="headerlink" href="#differentiable-hartree-fock" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_quantum_chemistry.html", "tutorial_vqe.html", "tutorial_givens_rotations.html", "tutorial_adaptive_circuits.html"];
    var related_tutorials_titles = ['Building molecular Hamiltonians', 'A brief overview of VQE', 'Givens rotations for quantum chemistry', 'Adaptive circuits for quantum chemistry'];
</script></p>
<p><em>Author: Soran Jahangiri — Posted: 09 May 2022. Last updated: 09 May 2022.</em></p>
<p>In this tutorial, you will learn how to use PennyLane’s differentiable Hartree-Fock solver
<a class="footnote-reference brackets" href="#arrazola2021" id="id1">1</a>. The quantum chemistry module in PennyLane, <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/qml_qchem.html#module-pennylane.qchem" title="(in PennyLane v0.30)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qml.qchem</span></code></a>,
provides built-in methods for constructing
atomic and molecular orbitals, building Fock matrices and solving the self-consistent field
equations to obtain optimized orbitals which can be used to construct fully-differentiable
molecular Hamiltonians. PennyLane allows users to natively compute derivatives of all these objects
with respect to the underlying parameters using the methods of
<a class="reference external" href="https://pennylane.ai/qml/glossary/automatic_differentiation.html">automatic differentiation</a>. We
introduce a workflow to jointly optimize circuit parameters, nuclear coordinates and basis set
parameters in a variational quantum eigensolver algorithm. You will also learn how to visualize the
atomic and molecular orbitals which can be used to create an animation like this:</p>
<div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../_images/h2.gif"><img alt="../_images/h2.gif" src="../_images/h2.gif" style="width: 60%;" /></a>
<p class="caption"><span class="caption-text">The bonding molecular orbital of hydrogen visualized during a full geometry, circuit and
basis set optimization.</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p>Let’s get started!</p>
<div class="section" id="differentiable-hamiltonians">
<h2>Differentiable Hamiltonians<a class="headerlink" href="#differentiable-hamiltonians" title="Permalink to this headline">¶</a></h2>
<p>Variational quantum algorithms aim to calculate the energy of a molecule by constructing a
parameterized quantum circuit and finding a set of parameters that minimize the expectation value of
the electronic <a class="reference external" href="https://en.wikipedia.org/wiki/Molecular_Hamiltonian">molecular Hamiltonian</a>. The
optimization can be carried out by computing the gradients of the expectation value with respect to
these parameters and iteratively updating them until convergence is achieved. In principle, the
optimization process is not limited to the circuit parameters and can be extended to include the
parameters of the Hamiltonian that can be optimized concurrently with the circuit parameters. The
aim is now to obtain the set of parameters that minimize the following expectation value</p>
<div class="math notranslate nohighlight">
\[\left \langle \Psi(\theta) | H(\beta) | \Psi(\theta) \right \rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> represent the circuit and Hamiltonian parameters,
respectively.</p>
<p>Computing the gradient of a molecular Hamiltonian is challenging because the dependency of the
Hamiltonian on the molecular parameters is typically not very straightforward. This makes symbolic
differentiation methods, which obtain derivatives of an input function by direct mathematical
manipulation, of limited scope. Furthermore, numerical differentiation methods based on
<a class="reference external" href="https://en.wikipedia.org/wiki/Finite_difference_method">finite differences</a> are not always
reliable due to their intrinsic instability, especially when the number of
differentiable parameters is large. These limitations can be alleviated by using automatic
differentiation methods which can be used to compute exact gradients of a function, implemented with
computer code, using resources comparable to those required to evaluate the function itself.</p>
<p>Efficient optimization of the molecular Hamiltonian parameters in a variational quantum algorithm
is essential for tackling problems such as
<a class="reference external" href="https://pennylane.ai/qml/demos/tutorial_mol_geo_opt.html">geometry optimization</a> and vibrational
frequency
calculations. These problems require computing the first- and second-order derivatives of the
molecular energy with respect to nuclear coordinates which can be efficiently obtained if the
variational workflow is automatically differentiable. Another important example is the simultaneous
optimization of the parameters of the basis set used to construct the atomic orbitals which can in
principle increase the accuracy of the computed energy without increasing the number of qubits in a
quantum simulation. The joint optimization of the circuit and Hamiltonian parameters can also be
used when the chemical problem involves optimizing the parameters of external potentials.</p>
</div>
<div class="section" id="the-hartree-fock-method">
<h2>The Hartree-Fock method<a class="headerlink" href="#the-hartree-fock-method" title="Permalink to this headline">¶</a></h2>
<p>The main goal of the Hartree-Fock method is to obtain molecular orbitals that minimize the
energy of a system where electrons are treated as independent particles that experience a mean field
generated by the other electrons. These optimized molecular orbitals are then used to
construct one- and two-body electron integrals in the basis of molecular orbitals, <span class="math notranslate nohighlight">\(\phi\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}h_{pq} =\int dx \,\phi_p^*(x)\left(-\frac{\nabla^2}{2}-\sum_{i=1}^N\frac{Z_i}{|r-R_i|}\right)\phi_q(x),\\\\\end{split}\]</div>
<div class="math notranslate nohighlight">
\[h_{pqrs} = \int dx_1 dx_2\, \frac{\phi_p^*(x_1)\phi_q^*(x_2)\phi_r(x_2)\phi_s(x_1)}{|r_1-r_2|}.\]</div>
<p>These integrals are used to generate a differentiable
<a class="reference external" href="https://en.wikipedia.org/wiki/Second_quantization">second-quantized</a> molecular Hamiltonian as</p>
<div class="math notranslate nohighlight">
\[H=\sum_{pq} h_{pq}a_p^\dagger a_q +\frac{1}{2}\sum_{pqrs}h_{pqrs}a_p^\dagger a_q^\dagger a_r a_s,\]</div>
<p>where <span class="math notranslate nohighlight">\(a^\dagger\)</span> and <span class="math notranslate nohighlight">\(a\)</span> are the fermionic creation and annihilation operators,
respectively. This Hamiltonian is then transformed to the qubit basis. Let’s see how this can be
done in PennyLane.</p>
<p>To get started, we need to define the atomic symbols and the nuclear coordinates of the molecule.
For the hydrogen molecule we have</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">autograd</span> <span class="kn">import</span> <span class="n">grad</span>
<span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">]</span>
<span class="c1"># optimized geometry at the Hartree-Fock level</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.672943567415407</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
                     <span class="p">[</span> <span class="mf">0.672943567415407</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The use of <code class="docutils literal notranslate"><span class="pre">requires_grad=True</span></code> specifies that the nuclear coordinates are differentiable
parameters. We can now compute the Hartree-Fock energy and its gradient with respect to the
nuclear coordinates. To do that, we create a molecule object that stores all the molecular
parameters needed to perform a Hartree-Fock calculation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">Molecule</span></a><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">)</span>
</pre></div>
</div>
<p>The Hartree-Fock energy can now be computed with the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.hf_energy.html#pennylane.qchem.hf_energy" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">hf_energy()</span></code></a> function which is a function transform</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.hf_energy.html#pennylane.qchem.hf_energy" title="pennylane.qchem.hf_energy" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">hf_energy</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">)(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array(-1.11751)
</pre></div>
</div>
<p>We now compute the gradient of the energy with respect to the nuclear coordinates</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grad</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.hf_energy.html#pennylane.qchem.hf_energy" title="pennylane.qchem.hf_energy" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">hf_energy</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">))(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>array([[ 1.84661e-05,  0.00000e+00,  0.00000e+00],
       [-1.84661e-05,  0.00000e+00,  0.00000e+00]])
</pre></div>
</div>
<p>The obtained gradients are equal or very close to zero because the geometry we used here has been
previously optimized at the Hartree-Fock level. You can use a different geometry and verify that
the newly computed gradients are not all zero.</p>
<p>We can also compute the values and gradients of several other quantities that are obtained during
the Hartree-Fock procedure. These include all integrals over basis functions, matrices formed from
these integrals and the one- and two-body integrals over molecular orbitals <a class="footnote-reference brackets" href="#arrazola2021" id="id2">1</a>.
Let’s look at a few examples.</p>
<p>We first compute the overlap integral between the two S-type atomic orbitals of the hydrogen
atoms. Here we are using the <a class="reference external" href="https://en.wikipedia.org/wiki/STO-nG_basis_sets">STO-3G</a>
basis set in which each of the atomic orbitals is represented by one basis function composed of
three primitive Gaussian functions. These basis functions can be accessed from the molecule
object as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S1</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="o">.</span><span class="n">basis_set</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S2</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="o">.</span><span class="n">basis_set</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>We can check the parameters of the basis functions as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">param</span></a> <span class="ow">in</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S1</span></a><span class="o">.</span><span class="n">params</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">param</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[3.42525 0.62391 0.16886]
[0.27693 0.26784 0.08347]
[-0.67294  0.       0.     ]
</pre></div>
</div>
<p>This returns the exponents, contraction coefficients and the centres of the three Gaussian
functions of the STO-3G basis set. These parameters can be also obtained individually by using
<code class="docutils literal notranslate"><span class="pre">S1.alpha</span></code>, <code class="docutils literal notranslate"><span class="pre">S1.coeff</span></code> and <code class="docutils literal notranslate"><span class="pre">S1.r</span></code>, respectively. You can verify that both of the <code class="docutils literal notranslate"><span class="pre">S1</span></code> an
<code class="docutils literal notranslate"><span class="pre">S2</span></code> atomic orbitals have the same exponents and contraction coefficients but are centred on
different hydrogen atoms. You can also verify that the orbitals are S-type by printing the angular
momentum quantum numbers with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S1</span></a><span class="o">.</span><span class="n">l</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(0, 0, 0)
</pre></div>
</div>
<p>This gives us a tuple of three integers, representing the exponents of the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>
and <span class="math notranslate nohighlight">\(z\)</span> components in the Gaussian functions <a class="footnote-reference brackets" href="#arrazola2021" id="id3">1</a>.</p>
<p>We can now compute the overlap integral,</p>
<div class="math notranslate nohighlight">
\[S_{\mu \nu} = \int \chi_\mu^* (r) \chi_\nu (r) dr\]</div>
<p>between the atomic orbitals <span class="math notranslate nohighlight">\(\chi\)</span>, by passing the orbitals and the initial values of their
centres to the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.overlap_integral.html#pennylane.qchem.overlap_integral" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">overlap_integral()</span></code></a> function. The centres of the orbitals
are those of the hydrogen atoms by default and are therefore treated as differentiable parameters
by PennyLane.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.overlap_integral.html#pennylane.qchem.overlap_integral" title="pennylane.qchem.overlap_integral" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">overlap_integral</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S1</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S2</span></a><span class="p">)([</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>tensor(0.4131, requires_grad=True)
</pre></div>
</div>
<p>You can verify that the overlap integral between two identical atomic orbitals is equal to one.
We can now compute the gradient of the overlap integral with respect to the orbital centres</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grad</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.overlap_integral.html#pennylane.qchem.overlap_integral" title="pennylane.qchem.overlap_integral" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">overlap_integral</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S1</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.BasisFunction.html#pennylane.qchem.BasisFunction" title="pennylane.qchem.BasisFunction" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">S2</span></a><span class="p">))([</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[array([0.39219, 0.     , 0.     ]), array([-0.39219,  0.     ,  0.     ])]
</pre></div>
</div>
<p>Can you explain why some of the computed gradients are zero?</p>
<p>Let’s now plot the atomic orbitals and their overlap. We can do it by using
the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule.atomic_orbital" title="(in PennyLane v0.30)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">atomic_orbital()</span></code></a> function, which evaluates the
atomic orbital at a given coordinate. For instance, the value of the S orbital on the first
hydrogen atom can be computed at the origin as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V1</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule.atomic_orbital" title="pennylane.qchem.Molecule.atomic_orbital" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-method"><span class="n">mol</span><span class="o">.</span><span class="n">atomic_orbital</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">V1</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>tensor(0.33796, requires_grad=True)
</pre></div>
</div>
<p>We can evaluate this orbital at different points along the <span class="math notranslate nohighlight">\(x\)</span> axis and plot it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="n">V1</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X [Bohr]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_differentiable_HF_001.png" srcset="../_images/sphx_glr_tutorial_differentiable_HF_001.png" alt="tutorial differentiable HF" class = "sphx-glr-single-img"/><p>We can also plot the second S orbital and visualize the overlap between them</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V2</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule.atomic_orbital" title="pennylane.qchem.Molecule.atomic_orbital" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-method"><span class="n">mol</span><span class="o">.</span><span class="n">atomic_orbital</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="n">V1</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="n">V2</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">V1</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">V2</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">hatch</span> <span class="o">=</span> <span class="s1">&#39;||&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X [Bohr]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_differentiable_HF_002.png" srcset="../_images/sphx_glr_tutorial_differentiable_HF_002.png" alt="tutorial differentiable HF" class = "sphx-glr-single-img"/><p>By looking at the orbitals, can you guess at what distance the value of the overlap becomes
negligible? Can you verify your guess by computing the overlap at that distance?</p>
<p>Similarly, we can plot the molecular orbitals of the hydrogen molecule obtained from the
Hartree-Fock calculations. We plot the cross-section of the bonding orbital on the <span class="math notranslate nohighlight">\(x-y\)</span>
plane.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># number of grid points along each axis</span>

<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="o">.</span><span class="n">mo_coefficients</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="o">.</span><span class="n">mo_coefficients</span><span class="o">.</span><span class="n">T</span>
<span class="n">mo</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule.molecular_orbital" title="pennylane.qchem.Molecule.molecular_orbital" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-method"><span class="n">mol</span><span class="o">.</span><span class="n">molecular_orbital</span></a><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span>
                   <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">val</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">mo</span><span class="p">)(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">val</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">val</span></a><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">_value</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">co</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">val</span></a><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;summer_r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">co</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span></a><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span></a><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X [Bohr]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y [Bohr]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_tutorial_differentiable_HF_003.png" srcset="../_images/sphx_glr_tutorial_differentiable_HF_003.png" alt="tutorial differentiable HF" class = "sphx-glr-single-img"/></div>
<div class="section" id="vqe-simulations">
<h2>VQE simulations<a class="headerlink" href="#vqe-simulations" title="Permalink to this headline">¶</a></h2>
<p>By performing the Hartree-Fock calculations, we obtain a set of one- and two-body integrals
over molecular orbitals that can be used to construct the molecular Hamiltonian with the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.molecular_hamiltonian.html#pennylane.qchem.molecular_hamiltonian" title="(in PennyLane v0.30)"><code class="xref py py-func docutils literal notranslate"><span class="pre">molecular_hamiltonian()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hamiltonian</span></a><span class="p">,</span> <span class="n">qubits</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.molecular_hamiltonian.html#pennylane.qchem.molecular_hamiltonian" title="pennylane.qchem.molecular_hamiltonian" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">molecular_hamiltonian</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="o">.</span><span class="n">symbols</span><span class="p">,</span>
                                                      <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span></a><span class="p">,</span>
                                                      <span class="n">args</span><span class="o">=</span><span class="p">[</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span></a><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.Hamiltonian.html#pennylane.Hamiltonian" title="pennylane.Hamiltonian" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hamiltonian</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>  (-0.2366648876198943) [Z2]
+ (-0.23666488761989424) [Z3]
+ (-0.05963862817464377) [I0]
+ (0.17575739479886338) [Z0]
+ (0.1757573947988635) [Z1]
+ (0.12222640951957497) [Z0 Z2]
+ (0.12222640951957497) [Z1 Z3]
+ (0.16714375519102576) [Z0 Z3]
+ (0.16714375519102576) [Z1 Z2]
+ (0.17001485407399825) [Z0 Z1]
+ (0.17570278345079388) [Z2 Z3]
+ (-0.04491734567145076) [Y0 Y1 X2 X3]
+ (-0.04491734567145076) [X0 X1 Y2 Y3]
+ (0.04491734567145076) [Y0 X1 X2 Y3]
+ (0.04491734567145076) [X0 Y1 Y2 X3]
</pre></div>
</div>
<p>The Hamiltonian contains 15 terms and, importantly, the coefficients of the Hamiltonian are all
differentiable. We can construct a circuit and perform a VQE simulation in which both of the
circuit parameters and the nuclear coordinates are optimized simultaneously by using the computed
gradients. We will have two sets of differentiable parameters: the first set is the
rotation angles of the excitation gates which are applied to the reference Hartree-Fock state
to construct the exact ground state. The second set contains the nuclear coordinates of the
hydrogen atoms.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dev</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">):</span>
    <span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;autograd&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">circuit</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.BasisState.html#pennylane.BasisState" title="pennylane.BasisState" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">BasisState</span></a><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.DoubleExcitation.html#pennylane.DoubleExcitation" title="pennylane.DoubleExcitation" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">DoubleExcitation</span></a><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="n">H</span> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.molecular_hamiltonian.html#pennylane.qchem.molecular_hamiltonian" title="pennylane.qchem.molecular_hamiltonian" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">molecular_hamiltonian</span></a><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="o">.</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">alpha</span></a><span class="p">,</span>
                                            <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span><span class="o">.</span><span class="n">coeff</span></a><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.expval.html#pennylane.expval" title="pennylane.expval" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">expval</span></a><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">circuit</span>
</pre></div>
</div>
<p>Note that we only use the <a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.DoubleExcitation.html#pennylane.DoubleExcitation" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DoubleExcitation</span></code></a> gate as the
<a class="reference external" href="https://docs.pennylane.ai/en/stable/code/api/pennylane.SingleExcitation.html#pennylane.SingleExcitation" title="(in PennyLane v0.30)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingleExcitation</span></code></a> ones can be neglected in this particular example
<a class="footnote-reference brackets" href="#szabo1996" id="id4">2</a>. We now compute the gradients of the energy with respect to the circuit parameter
and the nuclear coordinates and update the parameters iteratively. Note that the nuclear
coordinate gradients are simply the forces on the atomic nuclei.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial value of the circuit parameter</span>
<span class="n">circuit_param</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">):</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">circuit_param</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">Molecule</span></a><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">)</span>

    <span class="c1"># gradient for circuit parameters</span>
    <span class="n">g_param</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">),</span> <span class="n">argnum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">circuit_param</span> <span class="o">=</span> <span class="n">circuit_param</span> <span class="o">-</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">g_param</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># gradient for nuclear coordinates</span>
    <span class="n">forces</span> <span class="o">=</span> <span class="o">-</span><span class="n">grad</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">),</span> <span class="n">argnum</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">forces</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">, E: </span><span class="si">{</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="si">:</span><span class="s1">.8f</span><span class="si">}</span><span class="s1">, Force-max: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s1">.8f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>n: 0, E: -1.11750588, Force-max: 0.00001847
n: 5, E: -1.13514996, Force-max: 0.00410353
n: 10, E: -1.13704024, Force-max: 0.00210202
n: 15, E: -1.13727131, Force-max: 0.00084778
n: 20, E: -1.13730141, Force-max: 0.00032182
n: 25, E: -1.13730543, Force-max: 0.00011976
n: 30, E: -1.13730597, Force-max: 0.00004425
n: 35, E: -1.13730604, Force-max: 0.00001631
</pre></div>
</div>
<p>After 35 steps of optimization, the forces on the atomic nuclei and the gradient of the
circuit parameter are both approaching zero, and the energy of the molecule is that of the
optimized geometry at the
<a class="reference external" href="https://en.wikipedia.org/wiki/Full_configuration_interaction">full-CI</a> level:
<span class="math notranslate nohighlight">\(-1.1373060483\)</span> Ha. You can print the optimized geometry and verify that the final bond
length of hydrogen is identical to the one computed with full-CI which is <span class="math notranslate nohighlight">\(1.389\)</span>
<a class="reference external" href="https://en.wikipedia.org/wiki/Bohr_radius">Bohr</a>.</p>
<p>We are now ready to perform a full optimization where the circuit parameters, the nuclear
coordinates and the basis set parameters are all differentiable parameters that can be optimized
simultaneously.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial values of the nuclear coordinates</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.672943567415407</span><span class="p">],</span>
                     <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.672943567415407</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># initial values of the basis set exponents</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.42525091</span><span class="p">,</span> <span class="mf">0.62391373</span><span class="p">,</span> <span class="mf">0.1688554</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">3.42525091</span><span class="p">,</span> <span class="mf">0.62391373</span><span class="p">,</span> <span class="mf">0.1688554</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># initial values of the basis set contraction coefficients</span>
<a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1543289673</span><span class="p">,</span> <span class="mf">0.5353281423</span><span class="p">,</span> <span class="mf">0.4446345422</span><span class="p">],</span>
                  <span class="p">[</span><span class="mf">0.1543289673</span><span class="p">,</span> <span class="mf">0.5353281423</span><span class="p">,</span> <span class="mf">0.4446345422</span><span class="p">]],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># initial value of the circuit parameter</span>
<span class="n">circuit_param</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">):</span>

    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">circuit_param</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a><span class="p">]</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">qchem</span><span class="o">.</span><span class="n">Molecule</span></a><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a><span class="p">,</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a><span class="o">=</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a><span class="p">)</span>

    <span class="c1"># gradient for circuit parameters</span>
    <span class="n">g_param</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">),</span> <span class="n">argnum</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="n">circuit_param</span> <span class="o">=</span> <span class="n">circuit_param</span> <span class="o">-</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">g_param</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># gradient for nuclear coordinates</span>
    <span class="n">forces</span> <span class="o">=</span> <span class="o">-</span><span class="n">grad</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">),</span> <span class="n">argnum</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">geometry</span></a> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">forces</span>

    <span class="c1"># gradient for basis set exponents</span>
    <span class="n">g_alpha</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">),</span> <span class="n">argnum</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">alpha</span></a> <span class="o">-</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">g_alpha</span>

    <span class="c1"># gradient for basis set contraction coefficients</span>
    <span class="n">g_coeff</span> <span class="o">=</span> <span class="n">grad</span><span class="p">(</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">),</span> <span class="n">argnum</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a> <span class="o">=</span> <a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.numpy.tensor.html#pennylane.numpy.tensor" title="pennylane.numpy.tensor" class="sphx-glr-backref-module-pennylane-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coeff</span></a> <span class="o">-</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">g_coeff</span>

    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">, E: </span><span class="si">{</span><span class="n">energy</span><span class="p">(</span><a href="https://docs.pennylane.ai/en/stable/code/api/pennylane.qchem.Molecule.html#pennylane.qchem.Molecule" title="pennylane.qchem.Molecule" class="sphx-glr-backref-module-pennylane-qchem sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mol</span></a><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="si">:</span><span class="s1">.8f</span><span class="si">}</span><span class="s1">, Force-max: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">forces</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s1">.8f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>n: 0, E: -1.11750589, Force-max: 0.00001847
n: 5, E: -1.13767646, Force-max: 0.00608084
n: 10, E: -1.13994674, Force-max: 0.00300161
n: 15, E: -1.14030200, Force-max: 0.00147246
n: 20, E: -1.14036879, Force-max: 0.00068656
n: 25, E: -1.14038648, Force-max: 0.00031174
n: 30, E: -1.14039502, Force-max: 0.00013847
n: 35, E: -1.14040160, Force-max: 0.00005926
</pre></div>
</div>
<p>You can also print the gradients of the circuit and basis set parameters and confirm that they are
approaching zero. The computed energy of <span class="math notranslate nohighlight">\(-1.14040160\)</span> Ha is
lower than the full-CI energy, <span class="math notranslate nohighlight">\(-1.1373060483\)</span> Ha (obtained with the STO-3G basis set for
the hydrogen molecule) because we have optimized the basis set parameters in our example. This
means that we can reach a lower energy for hydrogen without increasing the basis set size, which
would otherwise lead to a larger number of qubits.</p>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<p>This tutorial introduces an important feature of PennyLane that allows performing
fully-differentiable Hartree-Fock and subsequently VQE simulations. This feature provides two
major benefits: i) All gradient computations needed for parameter optimization can be carried out
with the elegant methods of automatic differentiation which facilitates simultaneous optimizations
of circuit and Hamiltonian parameters in applications such as VQE molecular geometry
optimizations. ii) By optimizing the molecular parameters such as the exponent and contraction
coefficients of Gaussian functions of the basis set, one can reach a lower energy without
increasing the number of basis functions. Can you think of other interesting molecular parameters
that can be optimized along with the nuclear coordinates and basis set parameters that we
optimized in this tutorial?</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="arrazola2021"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>,<a href="#id3">3</a>)</span></dt>
<dd><p>Juan Miguel Arrazola, Soran Jahangiri, Alain Delgado, Jack Ceroni <em>et al.</em>, “Differentiable
quantum computational chemistry with PennyLane”. <a class="reference external" href="https://arxiv.org/abs/2111.09967">arXiv:2111.09967</a></p>
</dd>
<dt class="label" id="szabo1996"><span class="brackets"><a class="fn-backref" href="#id4">2</a></span></dt>
<dd><p>Attila Szabo, Neil S. Ostlund, “Modern Quantum Chemistry: Introduction to Advanced Electronic
Structure Theory”. Dover Publications, 1996.</p>
</dd>
</dl>
</div>
<div class="section" id="about-the-author">
<h2>About the author<a class="headerlink" href="#about-the-author" title="Permalink to this headline">¶</a></h2>
<div class="bio" >
    <div class="photo" >
        <img class="photo__img" src="../_static/authors/soran_jahangiri.png" alt="Soran Jahangiri" >
    </div>
    <div class="bio-text">
        <h4 class="bio-text__author-name">Soran Jahangiri</h4>
        <p class="bio-text__author-description">Soran Jahangiri is a quantum chemist working at Xanadu. His work is focused on developing and implementing quantum algorithms for chemistry applications.</p>
    </div>
</div><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  0.242 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-differentiable-hf-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/61eb3e62babbf8a51033253c1d0184d9/tutorial_differentiable_HF.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_differentiable_HF.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/1e156b9c8a2db37f7e689cd16d5764ac/tutorial_differentiable_HF.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_differentiable_HF.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    <script type="text/javascript">
        // This script ensures that the active navbar entry switches
        // from 'QML' to 'Demos' for any webpage within the demos/ directory,
        // or for any of the demonstration landing pages
        // (e.g., demos_optimization).
        var pagename = document.location.href.match(/[^\/]+$/)[0];
        var dir = document.URL.substr(0,document.URL.lastIndexOf('/')).match(/[^\/]+$/)[0];

        if (pagename.includes("demos") || pagename.includes("demonstrations") || dir.includes("demos")) {

            $(".nav-item.active").removeClass("active");
            var demos_link = $('.navbar-nav a').filter(function(index) { return $(this).text() === "Demos"; })[0]
            $(demos_link).parent().addClass("active");
        }
    </script>

              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_differentiable_HF</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>

            </div>
            
          </div>
        
<div class="localtoc-container nano has-scrollbar">
  <div class="nano-content">
    <div id="localtoc">
        
          <h3>Contents</h3>
          <!-- Display the ToC for the current document if it is not empty. -->
          <ul class='current'>
<li class='current'><a class="reference internal" href="#">Differentiable Hartree-Fock</a><ul class='current'>
<li class='current'><a class="reference internal" href="#differentiable-hamiltonians">Differentiable Hamiltonians</a></li>
<li class='current'><a class="reference internal" href="#the-hartree-fock-method">The Hartree-Fock method</a></li>
<li class='current'><a class="reference internal" href="#vqe-simulations">VQE simulations</a></li>
<li class='current'><a class="reference internal" href="#conclusions">Conclusions</a></li>
<li class='current'><a class="reference internal" href="#references">References</a></li>
<li class='current'><a class="reference internal" href="#about-the-author">About the author</a></li>
</ul>
</li>
</ul>

        
    </div>

    <div class="xanadu-call-to-action-links">
        <h3>Downloads</h3>
        <div id="tutorial-type">demos/tutorial_differentiable_HF</div>
        <div class="download-python-link">
            <i class="fab fa-python"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Python script</div>
        </div>
        <div class="download-notebook-link">
            <i class="fas fa-download"></i>&nbsp;
            <div class="call-to-action-desktop-view">Download Notebook</div>
        </div>
        <div class="github-view-link">
            <i class="fab fa-github"></i>&nbsp;
            <div class="call-to-action-desktop-view">View on GitHub</div>
        </div>
    </div>
    <div id="related-tutorials" class="mt-4">
      <h3> Related</h3>
    </div>
  </div>
</div>


    
          <div class="up-button">
            
              
                <a href="../demos_quantum-chemistry.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tutorial_adaptive_circuits.html" title="Adaptive circuits for quantum chemistry"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_givens_rotations.html" title="Givens rotations for quantum chemistry"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../quantum-computing.html" >Quantum Computing</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../demos_quantum-chemistry.html" >Quantum Chemistry</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Differentiable Hartree-Fock</a></li> 
      </ul>
    </div>
  <script type="text/javascript">
    $("#mobile-toggle").click(function () {
      $("#left-column").slideToggle("slow");
    });
  </script>

  <!-- jQuery -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- Bootstrap core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
  <!-- MDB core JavaScript -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
  <!-- NanoScroller -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.nanoscroller/0.8.7/javascripts/jquery.nanoscroller.min.js"></script>
  <!-- Syntax Highlighting -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script type="text/javascript">hljs.initHighlightingOnLoad();</script>

  <script type="text/javascript">
    $("a.reference.internal").each(function(){
      var link = $(this).attr("href");

      var hash = link.split("#")[1];
      var page = link.split("#")[0].split("/").slice(-1)[0].replace(".html", "");

      if (hash == page) {
        $(this).attr("href", link.split("#")[0]);
      }
    });

    $(".document > .section").removeClass("section");
    $("h1 ~ .section").removeClass("section");
    $(".localtoc-container .nano-content").css("height", $("#content").height());
    $(".localtoc-container").css("height", $("#content").height());
    $(".nano").nanoScroller();
  </script>

  <script type="text/javascript">
      $(window).scroll(function(){
        var scrollBottom = $(document).height() - $(window).height() - $(window).scrollTop();
        if (scrollBottom < 342) {
          $(".localtoc-container").css("height", "calc(100% - " + (342 - scrollBottom) + "px)");
          $(".localtoc-container .nano-content").css("height", "calc(100% - 119px)");
        }
      });
  </script>

  <script type="text/javascript">
    if ($(".current").length) {
      var target = $(".current")[0]
      var rect = target.getBoundingClientRect();
      if (rect.bottom > window.innerHeight) {
          $(".nano").nanoScroller({ scrollTo: $(".current") });
      } else {
          $(".nano").nanoScroller({ scrollTop: 0 });
      }
    }
    $(document).ready(function () {
        $(".css-transitions-only-after-page-load").each(function (index, element) {
            setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
        });
        if (window.location.hash) {
          var target = $("[id='" + window.location.hash.substr(1) + "']");
          if (target.closest(".collapse").length) {
            target.closest(".collapse").addClass("show");
            target.closest(".collapse").prev().find(".rotate").addClass("up");
          }
        }
    });
  </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "PennyLaneAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href;

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();

    } else {
          $("#related-tutorials").hide();
    }
    </script>

  <!-- Account for MathJax when navigating to anchor tags. -->
  <script type="text/javascript">
    function scrollToElement(e) {
      // Scrolls to the given element, taking into account the navbar.
      MathJax.Hub.Queue(function() {
        // The following MUST be done asynchronously to take effect.
        setTimeout(function() {
          const navbar = document.querySelector("nav.navbar");
          const navbarHeight = navbar ? navbar.offsetHeight : 0;
          const scrollToY = e.offsetTop + e.offsetParent.offsetTop - navbarHeight;
          window.scrollTo(0, scrollToY);
        }, 0);
      });
    }

    function scrollToFragment(fragment) {
      // Scrolls to the position of the given URL fragment (which includes the "#").
      const elementID = fragment.replace(".", "\\.");
      if (elementID !== "") {
        const element = document.querySelector(elementID);
        if (element !== null) {
          scrollToElement(element);
        }
      }
    }

    $(document).ready(() => {
      scrollToFragment(window.location.hash);
      window.addEventListener("popstate", (_) => scrollToFragment(document.location.hash), false);
    });
  </script>

  <!-- Hide the rendering of :orphan: metadata. -->
  <script type="text/javascript">
    $(document).ready(() => {
      const elements = document.getElementsByClassName("field-odd");
      for (const element of elements) {
          if (element.innerHTML.trim() === "orphan") {
            element.style.display = "none";
          }
      }
    });
  </script>

  <script type="text/javascript">
    jQuery.noConflict(true);
  </script>

  

<footer class="page-footer text-md-left pt-4">

  <hr class="pb-0 mb-0">
  <div class="container-fluid">
    <div class="row justify-content-md-center">

      
      <!-- About -->
      <div class="col-md-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <p>        PennyLane is an open-source software framework for quantum
        machine learning, quantum chemistry, and quantum computing, 
        with the ability to run on all hardware.
        Maintained with ❤️ by Xanadu.
        </p>
      </div>
      

      <!-- Links -->
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">PennyLane</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://pennylane.ai/">Home</a></li>
          
          <li><a href="https://pennylane.ai/qml">Learn</a></li>
          
          <li><a href="https://pennylane.ai/qml/demonstrations.html">Demonstrations</a></li>
          
          <li><a href="https://docs.pennylane.ai/">Documentation</a></li>
          
          <li><a href="https://github.com/PennyLaneAI/pennylane">GitHub</a></li>
          
          <li><a href="https://twitter.com/pennylaneai">Twitter</a></li>
          
          <li><a href="https://pennylane.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      
      <div class="col-md-2 col-4">
        <h5 class="mb-1 footer-heading">Xanadu</h5>
        <hr width=100px class="d-inline-block mt-0 mb-1 accent-4">
        <ul class="list-unstyled">
          
          <li><a href="https://xanadu.ai/">Home</a></li>
          
          <li><a href="https://xanadu.ai/about/">About</a></li>
          
          <li><a href="https://xanadu.ai/photonics">Hardware</a></li>
          
          <li><a href="https://xanadu.ai/careers/">Careers</a></li>
          
          <li><a href="https://cloud.xanadu.ai">Cloud</a></li>
          
          <li><a href="https://discuss.pennylane.ai/">Forum</a></li>
          
          <li><a href="https://xanadu.ai/blog">Blog</a></li>
          
        </ul>
      </div>
      

    </div>
  </div>
  <hr>

  <!-- Social -->
  <div class="social-section text-center">
      <ul class="list-unstyled list-inline mb-0">
          
          <li class="list-inline-item"><a class="btn-git" href="https://twitter.com/PennyLaneAI"><i class="fab fa-twitter"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://github.com/PennyLaneAI/pennylane"><i class="fab fa-github"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://discuss.pennylane.ai"><i class="fab fa-discourse"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://xanadu-quantum.slack.com/join/shared_invite/zt-nkwn25v9-H4hituCb_PUj4idG0MhSug#/shared-invite/email"><i class="fab fa-slack"> </i></a></li>
          
          <li class="list-inline-item"><a class="btn-git" href="https://pennylane.ai/blog/"><i class="fas fa-rss"> </i></a></li>
          
      </ul>
      
        
          <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">
            Stay updated with our newsletter
          </a>
        
      
  </div>

  <!-- Copyright -->
  <div class="footer-copyright py-3 mt-0 text-center">
      <div class="container-fluid">
            Copyright &copy; 2022, Xanadu Quantum Technologies, Inc.

        
          <br>
          TensorFlow, the TensorFlow logo, and any related marks are trademarks of Google Inc.
        
      </div>
  </div>
</footer>
  </body>
</html>